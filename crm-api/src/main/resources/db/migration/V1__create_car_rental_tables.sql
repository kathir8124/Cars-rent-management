-- Flyway migration script to create the database schema for the car rental system.

-- Creating the `cars` table.
CREATE TABLE cars (
    car_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    model VARCHAR(255) NOT NULL,
    status ENUM('IDLE', 'ON_LEASE', 'ON_SERVICE') NOT NULL,
    variant VARCHAR(255) NOT NULL,
    owner_id INT NOT NULL
);

-- Creating the `customers` table.
CREATE TABLE customers (
    customer_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email VARCHAR(255) NOT NULL UNIQUE,
    name VARCHAR(255) NOT NULL,
    phone_number VARCHAR(255) NOT NULL
);

-- Creating the `leases` table.
CREATE TABLE leases (
    lease_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    end_date TIMESTAMP(6),
    start_date TIMESTAMP(6) NOT NULL,
    status ENUM('ACTIVE', 'ENDED') NOT NULL,
    car_id INT NOT NULL,
    customer_id INT NOT NULL
);

-- Creating the `owners` table.
CREATE TABLE owners (
    owner_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email VARCHAR(255) NOT NULL UNIQUE,
    name VARCHAR(255) NOT NULL,
    phone_number VARCHAR(255) NOT NULL
);

-- Adding foreign key constraints for `cars` and `owners`.
ALTER TABLE cars
    ADD CONSTRAINT FK_cars_owner_id FOREIGN KEY (owner_id) REFERENCES owners(owner_id);

-- Adding foreign key constraints for `leases` and `cars`.
ALTER TABLE leases
    ADD CONSTRAINT FK_leases_car_id FOREIGN KEY (car_id) REFERENCES cars(car_id);

-- Adding foreign key constraints for `leases` and `customers`.
ALTER TABLE leases
    ADD CONSTRAINT FK_leases_customer_id FOREIGN KEY (customer_id) REFERENCES customers(customer_id);

-- Inserting sample data

-- Inserting data into owners table
INSERT INTO owners (name, email, phone_number) VALUES ('John Doe', 'john.doe@email.com', '1234567890');
INSERT INTO owners (name, email, phone_number) VALUES ('Jane Smith', 'jane.smith@email.com', '2345678901');
INSERT INTO owners (name, email, phone_number) VALUES ('Sam Wilson', 'sam.wilson@email.com', '3456789012');
INSERT INTO owners (name, email, phone_number) VALUES ('Mia Taylor', 'mia.taylor@email.com', '4567890123');
INSERT INTO owners (name, email, phone_number) VALUES ('Robert Brown', 'robert.brown@email.com', '5678901234');
INSERT INTO owners (name, email, phone_number) VALUES ('Emma Davis', 'emma.davis@email.com', '6789012345');
INSERT INTO owners (name, email, phone_number) VALUES ('Oliver Green', 'oliver.green@email.com', '7890123456');
INSERT INTO owners (name, email, phone_number) VALUES ('Sophia White', 'sophia.white@email.com', '8901234567');
INSERT INTO owners (name, email, phone_number) VALUES ('William Harris', 'william.harris@email.com', '9012345678');
INSERT INTO owners (name, email, phone_number) VALUES ('Liam Lewis', 'liam.lewis@email.com', '0123456789');

-- Inserting data into customers table
INSERT INTO customers (name, email, phone_number) VALUES ('Alice Cooper', 'alice.cooper@email.com', '1230987654');
INSERT INTO customers (name, email, phone_number) VALUES ('Bob Martin', 'bob.martin@email.com', '2341098765');
INSERT INTO customers (name, email, phone_number) VALUES ('Charlie Johnson', 'charlie.johnson@email.com', '3452109876');
INSERT INTO customers (name, email, phone_number) VALUES ('David Lee', 'david.lee@email.com', '4563210987');
INSERT INTO customers (name, email, phone_number) VALUES ('Eva Adams', 'eva.adams@email.com', '5674321098');
INSERT INTO customers (name, email, phone_number) VALUES ('Frank Wright', 'frank.wright@email.com', '6785432109');
INSERT INTO customers (name, email, phone_number) VALUES ('Grace Martin', 'grace.martin@email.com', '7896543210');
INSERT INTO customers (name, email, phone_number) VALUES ('Henry Scott', 'henry.scott@email.com', '8907654321');
INSERT INTO customers (name, email, phone_number) VALUES ('Isla Clark', 'isla.clark@email.com', '9018765432');
INSERT INTO customers (name, email, phone_number) VALUES ('Jack Allen', 'jack.allen@email.com', '0129876543');

-- Inserting data into cars table
INSERT INTO cars (owner_id, model, variant, status) VALUES (1, 'Toyota Corolla', 'XLE', 'IDLE');
INSERT INTO cars (owner_id, model, variant, status) VALUES (2, 'Honda Civic', 'LX', 'ON_LEASE');
INSERT INTO cars (owner_id, model, variant, status) VALUES (3, 'Ford Focus', 'SE', 'ON_SERVICE');
INSERT INTO cars (owner_id, model, variant, status) VALUES (4, 'Chevrolet Malibu', 'LT', 'IDLE');
INSERT INTO cars (owner_id, model, variant, status) VALUES (5, 'BMW 3 Series', '330i', 'ON_LEASE');
INSERT INTO cars (owner_id, model, variant, status) VALUES (6, 'Audi A4', 'Premium', 'ON_SERVICE');
INSERT INTO cars (owner_id, model, variant, status) VALUES (7, 'Mercedes-Benz C-Class', 'C300', 'IDLE');
INSERT INTO cars (owner_id, model, variant, status) VALUES (8, 'Hyundai Sonata', 'SEL', 'ON_LEASE');
INSERT INTO cars (owner_id, model, variant, status) VALUES (9, 'Nissan Altima', 'SV', 'ON_SERVICE');
INSERT INTO cars (owner_id, model, variant, status) VALUES (10, 'Kia Optima', 'EX', 'IDLE');

-- Inserting data into leases table
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (1, 1, '2024-01-01 10:00:00', '2024-12-31 10:00:00', 'ACTIVE');
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (2, 2, '2024-03-15 12:00:00', '2025-03-15 12:00:00', 'ACTIVE');
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (3, 3, '2024-05-20 14:00:00', '2024-11-20 14:00:00', 'ENDED');
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (4, 4, '2024-06-10 08:00:00', '2025-06-10 08:00:00', 'ACTIVE');
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (5, 5, '2024-07-01 09:00:00', '2024-12-31 09:00:00', 'ACTIVE');
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (6, 6, '2024-08-15 13:00:00', '2025-08-15 13:00:00', 'ACTIVE');
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (7, 7, '2024-09-10 15:00:00', '2025-09-10 15:00:00', 'ENDED');
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (8, 8, '2024-10-05 16:00:00', '2025-10-05 16:00:00', 'ACTIVE');
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (9, 9, '2024-11-01 17:00:00', '2025-11-01 17:00:00', 'ACTIVE');
INSERT INTO leases (car_id, customer_id, start_date, end_date, status)
VALUES (10, 10, '2024-12-01 11:00:00', '2025-12-01 11:00:00', 'ACTIVE');
